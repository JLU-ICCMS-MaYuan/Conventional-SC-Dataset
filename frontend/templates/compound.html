<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>元素组合 - 超导文献数据库</title>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- 头部 -->
    <div class="compound-header text-center">
        <div class="container">
            <h1 id="compound-title">加载中...</h1>
            <p class="lead" id="compound-subtitle">超导体文献数据库</p>
            <button onclick="window.location.href='/'" class="btn btn-light">返回元素周期表</button>
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#uploadModal">上传文献</button>
        </div>
    </div>

    <div class="container mt-4">
        <!-- 审核状态筛选 -->
        <div class="card mb-3">
            <div class="card-body">
                <div class="btn-group" role="group">
                    <input type="radio" class="btn-check" name="review-status" id="status-all" value="all" checked>
                    <label class="btn btn-outline-primary" for="status-all" onclick="filterByReviewStatus('all')">全部文献</label>

                    <input type="radio" class="btn-check" name="review-status" id="status-reviewed" value="reviewed">
                    <label class="btn btn-outline-success" for="status-reviewed" onclick="filterByReviewStatus('reviewed')">已审核</label>

                    <input type="radio" class="btn-check" name="review-status" id="status-unreviewed" value="unreviewed">
                    <label class="btn btn-outline-warning" for="status-unreviewed" onclick="filterByReviewStatus('unreviewed')">未审核</label>
                </div>
            </div>
        </div>

        <!-- 搜索和筛选 -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="keyword-input" placeholder="搜索关键词（标题、作者、化学式）">
                    </div>
                    <div class="col-md-2">
                        <input type="number" class="form-control" id="year-min-input" placeholder="最小年份">
                    </div>
                    <div class="col-md-2">
                        <input type="number" class="form-control" id="year-max-input" placeholder="最大年份">
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-primary w-100" onclick="searchPapers()">搜索</button>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-secondary w-100" onclick="resetSearch()">重置</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 文献列表 -->
        <div id="papers-container">
            <div class="text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">加载中...</span>
                </div>
                <p class="mt-3">正在加载文献...</p>
            </div>
        </div>
    </div>

    <!-- 上传文献模态框 -->
    <div class="modal fade" id="uploadModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">上传文献</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="uploadForm">
                        <div class="mb-3">
                            <label class="form-label">DOI <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="doi-input" required placeholder="例如: 10.1038/nature12345">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">文章类型 <span class="text-danger">*</span></label>
                            <div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="article-type" id="article-experimental" value="experimental" required>
                                    <label class="form-check-label" for="article-experimental">
                                        🔬 实验文章（理论+实验也归此类）
                                    </label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="article-type" id="article-theoretical" value="theoretical">
                                    <label class="form-check-label" for="article-theoretical">
                                        ⚛️ 理论文章
                                    </label>
                                </div>
                            </div>
                            <small class="text-muted">提示：如果文章既有理论又有实验，请选择"实验文章"</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">超导体类型 <span class="text-danger">*</span></label>
                            <select class="form-select" id="superconductor-type-input" required>
                                <option value="">请选择超导体类型</option>
                                <option value="conventional">🔵 常规超导体</option>
                                <option value="unconventional">🟣 非常规超导体</option>
                                <option value="unknown">⚪ 未知类型</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">化学式</label>
                            <input type="text" class="form-control" id="formula-input" placeholder="例如: YBa₂Cu₃O₇">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">晶体结构类型</label>
                            <input type="text" class="form-control" id="structure-input" list="structure-datalist" placeholder="例如: 钙钛矿型" autocomplete="off">
                            <datalist id="structure-datalist">
                                <!-- 动态加载已有的晶体结构类型 -->
                            </datalist>
                            <small class="text-muted">💡 输入时会显示已有的晶体结构类型，也可以填写新的类型</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">物理数据 (压强/Tc/λ等) <span class="text-danger">*</span></label>
                            <div id="data-points-container">
                                <!-- 动态数据行 -->
                                <div class="data-row card p-3 mb-2 bg-light">
                                    <div class="row g-2">
                                        <div class="col-md-3">
                                            <label class="small">压强 (GPa) *</label>
                                            <input type="number" step="any" class="form-control form-control-sm pressure-val" required placeholder="0.0">
                                        </div>
                                        <div class="col-md-3">
                                            <label class="small">Tc (K) *</label>
                                            <input type="number" step="any" class="form-control form-control-sm tc-val" required placeholder="0.0">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="small">λ</label>
                                            <input type="number" step="any" class="form-control form-control-sm lambda-val" placeholder="λ">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="small">ω_log</label>
                                            <input type="number" step="any" class="form-control form-control-sm omega-val" placeholder="ω">
                                        </div>
                                        <div class="col-md-2">
                                            <label class="small">N(Ef)</label>
                                            <input type="number" step="any" class="form-control form-control-sm nef-val" placeholder="N">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm mt-1" onclick="addDataRow()">+ 添加一组数据</button>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">贡献者姓名</label>


                            <input type="text" class="form-control" id="contributor-name-input" placeholder="默认: 匿名贡献者">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">贡献者单位</label>
                            <input type="text" class="form-control" id="contributor-affiliation-input" placeholder="默认: 未提供单位">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">文献截图 (0-5张)</label>
                            <input type="file" class="form-control" id="images-input" multiple accept="image/*">
                            <small class="text-muted">请上传文献截图，优先上传化合物结构图</small>
                            <div id="image-preview" class="image-preview-container mt-2"></div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">备注</label>
                            <textarea class="form-control" id="notes-input" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" onclick="submitPaper()">提交</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 图片查看模态框 -->
    <div class="modal fade" id="imageModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">查看图片</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="modal-image" class="img-fluid" alt="文献截图">
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/compound_page.js"></script>
</body>
</html>
